
<form class="form-horizontal">
    <fieldset ng-controller="RxNormReview">
        <table>
            <thead>
                <tr>
                    <td class="col-sm-8">
                        <div class="control-group">
                            <label class="control-label" for="reviewers">&nbsp;&nbsp;&nbsp;Reviewers:&nbsp;&nbsp;</label>
                            <select id="reviewers" 
                                name="reviewers" 
                                class="dropdown-toggle" 
                                data-toggle="dropdown" 
                                ng-model="selection.reviewer"
                                ng-change="initializeValues({{cuis.ind}});"
                                onchange="changeReviewer();">
                                <option value="">Select a reviewer</option>
                                <option ng-repeat="mainrev in mainReviewers" 
                                    value="{{mainrev}}">{{mainrev}}</option>
                                <option ng-repeat="guestrev in guestReviewers" 
                                    value="{{guestrev}}">{{guestrev}}</option>
                            </select>
                            <label ng-show="!selection.reviewer" style="color:red">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please select a reviewer to continue...</label>
                        </div>
                    </td>
                </tr>
                <tr><td>&nbsp;</td></tr>
                <tr class="col-sm-8" ng-hide="!selection.reviewer">
                    <td><span id="counterDisp" style="color:green;font-style:italic">
                    &nbsp;&nbsp;&nbsp;Reviewing&nbsp;:&nbsp;({{cuis.ind + 1}}&nbsp;of&nbsp;{{cuis.entries.length}})&nbsp;
                    [&nbsp;Status:&nbsp;<u><span id="review_status" style="color:orange">{{currentReviewStatus[0].review_status}}</span></u>&nbsp;]</span></td>
                </tr>
                <tr>
                    <td>&nbsp;
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr ng-hide="!selection.reviewer">
                    <td>
                        <fieldset ng-disabled="!selection.reviewer">
                            <table>
                                <tr>
                                    <td class="col-sm-8">
                                        <table>
                                            <tr>
                                                <td class="col-sm-8">
                                                    <table><tr><td><b>RxCUI:</b></td><td>
                                                    &nbsp;&nbsp;<span id="scd_rxcui">{{cuis.entries[cuis.ind]['SCD_rxcui']}}</span>
                                                    </td><td>&nbsp;&nbsp;
                                                    <b>Drug(SCD):</b></td><td style="word-wrap: break-word;">
                                                    &nbsp;&nbsp;<span id="scd_df">{{existing[0]['SCD_str']}}</span></td>
                                                    </tr></table>
                                                </td>
                                                <td class="col-sm-4" rowspan="5" align="top">
                                                    <div class="panel panel-warning">
                                                        <div class="panel-heading">
                                                                <h3 class="panel-title">Comment</h3>
                                                        </div>
                                                        <div class="panel-body">
                                                            <table>
                                                                <tr width="100%">
                                                                    <td width="2%"><span id="{{propertyList[10][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                            onClick="setSelectedProperty(this.id, 10)"></span></td><td width="98%"><h4>&nbsp;&nbsp;Reviewer:&nbsp;&nbsp;<b><span id="currentReviewer"></span></b></h4></td>
                                                                </tr> 
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <div class="control-group">
                                                                            <label class="control-label" for="reviewers">Please add comments for </label>
                                                                            <select id="selectedProperty" 
                                                                                    name="selectedProperty" 
                                                                                    class="dropdown-toggle" 
                                                                                    data-toggle="dropdown" 
                                                                                    ng-model="selection.property"
                                                                                    onchange="changeSelectedProperty()"
                                                                                    ng-disabled="(currentReviewStatus[0].review_status == 'Complete')"
                                                                                    style="height:230px"
                                                                                    multiple>
                                                                                    <option ng-repeat="prop in propertyList" 
                                                                                    value="{{prop[1]}}">{{prop[1]}}</option>
                                                                            </select>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr><td colspan="2">&nbsp;</td></tr>
                                                                <tr>
                                                                    <td colspan="2"><textarea id="currentComment" ng-model="newComemnt" style="hieght:100%" class="form-control col-xs-12" ng-disabled="!selection.property"></textarea></td>
                                                                </tr>
                                                                <tr><td colspan="2">&nbsp;</td></tr>
                                                                <tr><td colspan="2"><button id="addCommentButton" name="okButtonName" class="btn btn-success" onclick="addComment()" ng-disabled="(!selection.property)||(currentReviewStatus[0].review_status == 'Complete')">Update</button></td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr><td>&nbsp;</td></tr>
                                            <tr>
                                                <td class="col-sm-8">
                                                    <div class="panel panel-success">
                                                        <div class="panel-heading">
                                                            <h3 class="panel-title">Exisitng</h3>
                                                        </div>
                                                        <div class="panel-body">
                                                            <table width="100%">
                                                                <tr>
                                                                    <td width="34%">
                                                                    <div class="alert alert-info" role="alert"><b>RxNorm DF:&nbsp;<span style="color:black">{{existing[0]['DF_str']}}</span></b></div></td>
                                                                
                                                                    <td width="33%">
                                                                    <div class="alert alert-info" role="alert"><b>RxTndF:&nbsp;<span style="color:black">{{existing[0]['NEWDF_rxt']}}</span></b></div></td>
                                                               
                                                                    <td width="33%">
                                                                    <div class="alert alert-info" role="alert"><b>RxTroute:&nbsp;<span style="color:black">{{existing[0]['ROUTE_rxt']}}</span></b></div></td>
                                                                </tr>
                                                                <tr><td colspan="3"><span style="color:blue"> <font size="2">{{getBreadcrumbs(-1, existing[0]['DF_str'])}}</font></span></td></tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="col-sm-8">
                                                    <div class="panel panel-primary">
                                                        <div class="panel-heading">
                                                            <h3 class="panel-title">Proposed
                                                            <span class="label label-danger" ng-show="showConflict(existing[0]['conflict'])">[Conflicts found due to multiple proposed values]</span></h3>
                                                        </div>
                                                        <div class="panel-body">
                                                            <table cellpadding="20" cellspacing="20" width="100%">
                                                                <tr><td border="0"><h4><span class="label label-default">Dose Forms</span></h4></td></tr>
                                                                <tr>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[0][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop1']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[0][1]}}" style ="color:blue" class='glyphicon glyphicon-stop' 
                                                                        onClick="setSelectedProperty(this.id, 0)"></span>
                                                                        <span id="OK{{propertyList[0][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[0][0]}}" type="hidden" value="{{commentList[0][1]}}" onchange="toggleColor(0)" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                    <b>{{propertyList[1][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop3']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[1][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 1)"></span>
                                                                        <span id="OK{{propertyList[1][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[1][0]}}" type="hidden" value="{{commentList[1][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[2][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop2']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[2][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 2)"></span>
                                                                        <span id="OK{{propertyList[2][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[2][0]}}" type="hidden" value="{{commentList[2][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[3][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop4']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[3][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 3)"></span>
                                                                        <span id="OK{{propertyList[3][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[3][0]}}" type="hidden" value="{{commentList[3][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                </tr>
                                                                <tr height="20px"><td><h4><span class="label label-default">Administration</span></h4></td></tr>
                                                                <tr>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[4][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop5']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[4][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 4)"></span>
                                                                        <span id="OK{{propertyList[4][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[4][0]}}" type="hidden" value="{{commentList[4][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[5][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop6']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[5][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 5)"></span>
                                                                        <span id="OK{{propertyList[5][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[5][0]}}" type="hidden" value="{{commentList[5][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                </tr>
                                                                <tr><td><h4><span class="label label-default">Delivery Device</span></h4></td></tr>
                                                                <tr>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[6][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop7']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[6][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 6)"></span>
                                                                        <span id="OK{{propertyList[6][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[6][0]}}" type="hidden" value="{{commentList[6][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[9][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop9']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[9][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 9)"></span>
                                                                        <span id="OK{{propertyList[9][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[9][0]}}" type="hidden" value="{{commentList[9][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[7][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop8']}}</b></span>
                                                                        </div>
                                                                        </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[7][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 7)"></span>

                                                                        <span id="OK{{propertyList[7][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[7][0]}}" type="hidden" value="{{commentList[7][1]}}" ng-click="storeComment($event)"></input></td>
                                                                    <td width="45%">
                                                                        <div class="alert alert-warning" role="alert">
                                                                        <b>{{propertyList[8][1].split(":")[1].trim()}}:</b>&nbsp;&nbsp;
                                                                        <span style="color:black"><b>{{existing[0]['prop10']}}</b></span>
                                                                        </div>
                                                                    </td>
                                                                    <td width="5%">
                                                                        <span id="{{propertyList[8][1]}}" style ="color:blue" class='glyphicon glyphicon-stop'
                                                                        onClick="setSelectedProperty(this.id, 8)"></span>
                                                                        <span id="OK{{propertyList[8][0]}}" style ="color:green;visibility:hidden" class='glyphicon glyphicon-ok' ></span>
                                                                        <input id="NEW{{propertyList[8][0]}}" type="hidden" value="{{commentList[8][1]}}" ng-click="storeComment($event)"></input>
                                                                        <input id="NEW{{propertyList[10][0]}}" type="hidden" value="{{commentList[10][1]}}" ng-click="storeComment($event)"></input>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="col-sm-8">
                                                    <div class="control-group" >
                                                        <div class="controls" align="center">
                                                            <table>
                                                                <tr>
                                                                    <td class="col-sm-4"></td>
                                                                    <input id="okButtonTitle" type="hidden" value="{{reviewButtonText}}"></input>
                                                                    <td class="col-sm-1"><button id="prevButton" name="prevButtonName" class="btn btn-primary" onclick="resetOK()" ng-click="getPrev(currentReviewStatus[0].review_status);" ng-disabled="(cuis.ind == 0)">Previous</button></td>
                                                                    <td class="col-sm-1"><button id="okButton" name="okButtonName" class="btn btn-success" style="{{reviewButtonColor}}" onclick="setOK()" ng-disabled="(currentReviewStatus[0].review_status == 'Complete')">{{reviewButtonText}}</button></td>
                                                                    <td class="col-sm-1"><button id="nextButton" name="nextButtonName" class="btn btn-primary" onclick="resetOK()" ng-click="getNext($event, cuis.entries[cuis.ind]['SCD_rxcui'], currentReviewStatus[0].review_status);">SKIP & Next</button></td>
                                                                    <td class="col-sm-4"></td>
                                                                </tr>
                                                            </table>
                                                        </div> 
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </fieldset>                
                    </td>
                </tr>
            </tbody>
        </table>
    </fieldset>
</form>
